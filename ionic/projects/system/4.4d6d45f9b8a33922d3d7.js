(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{YhWy:function(e,s,t){"use strict";t.r(s),t.d(s,"CreatePageModule",function(){return w});var i=t("tyNb"),n=t("mrSG"),r=t("WqAO"),o=t("RqZA"),c=t("yoGk"),a=t("fXoL"),l=t("IfTO"),u=t("CzVY"),b=t("hBPn"),h=t("TEn/"),d=t("3Pt+"),p=t("ofXK");function g(e,s){if(1&e&&(a.Rb(0,"span"),a.zc(1),a.Qb()),2&e){const e=a.dc();a.zb(1),a.Bc(" ",e.user.access_level.name," ")}}function m(e,s){1&e&&(a.Rb(0,"span"),a.zc(1," Select... "),a.Qb())}const v=function(){return["/users"]};let f=(()=>{class e{constructor(e,s,t,i,n,o){this.route=e,this.router=s,this.helperService=t,this.accessLevelService=i,this.userService=n,this.modalController=o,this.editing=!1,this.permissionAlert={header:"Access levels",translucent:!0},this.compareWithFn=(e,s)=>e&&s?e.id===s.id:e===s,this.compareWith=this.compareWithFn,this.user=new r.a}ngOnInit(){this.id=this.id=this.route.snapshot.paramMap.get("id")?parseInt(this.route.snapshot.paramMap.get("id")):null,this.getAccessLevels(),this.id&&(this.editing=!0,this.getUser())}compareById(e,s){return e&&s&&e.id==s.id}getUser(){this.userService.find(["access_level","authenticable"],{id:this.id}).then(e=>{this.user=new r.a(e.user)},e=>{401==e.status?(this.router.navigateByUrl("login"),this.helperService.toast("secondary","Your session has expired, please enter your credentials again.")):this.helperService.toast("danger","Error fetching users")})}save(){this.user.id>0?this.update():this.store()}store(){this.userService.store(this.user).then(e=>{if(e.error)return this.helperService.toast("danger",e.message),!1;this.helperService.toast("success",e.message),this.user=new r.a(e.user),this.router.navigate(["users/"+this.user.id],{state:{force:!0}})},e=>{this.helperService.responseErrors(e)})}update(){this.userService.update(this.user).then(e=>{if(e.error)return this.helperService.toast("danger",e.message),!1;this.helperService.toast("success",e.message)},e=>{this.helperService.responseErrors(e)})}getAccessLevels(){this.accessLevelService.get().then(e=>{if(e.error)this.access_levels=[],this.helperService.toast("danger",e.message);else{this.access_levels=[];for(let s of e.access_levels)s.id<=2&&this.access_levels.push(new o.a(s))}},e=>{this.helperService.responseErrors(e)})}selectAccessLevel(){return Object(n.a)(this,void 0,void 0,function*(){const e=yield this.modalController.create({component:c.a,componentProps:{title:"N\xedveis de acesso",options:this.access_levels}});yield e.present();const{data:s}=yield e.onWillDismiss();s&&this.user.serialize({access_level:s})})}selectCustomer(){return Object(n.a)(this,void 0,void 0,function*(){const e=yield this.modalController.create({component:c.a,componentProps:{title:"Clientes",options:this.customers}});yield e.present();const{data:s}=yield e.onWillDismiss();s&&(this.user.serialize({authenticable:s}),this.user.authenticable_id=s.id,this.user.authenticable_type="customers")})}}return e.\u0275fac=function(s){return new(s||e)(a.Lb(i.a),a.Lb(i.f),a.Lb(l.a),a.Lb(u.a),a.Lb(b.a),a.Lb(h.S))},e.\u0275cmp=a.Fb({type:e,selectors:[["app-create"]],decls:45,vars:11,consts:[["slot","start"],["icon","chevron-back-outline","mode","ios","text","",3,"routerLink"],[1,"ion-no-padding"],["color","white","no-margin","","mode","ios"],["size","12","size-sm","6"],["color","medium",1,"fw-600"],[1,"input-light",3,"ngModel","ngModelChange"],[1,"input-light",3,"click"],[4,"ngIf"],["type","email",1,"input-light",3,"ngModel","ngModelChange"],["size","12","size-sm","6",1,"text-right"],["type","password",1,"input-light",3,"ngModel","placeholder","ngModelChange"],["color","primary"],["size-sm","4"],["expand","full","shape","round","mode","ios","color","success",3,"click"]],template:function(e,s){1&e&&(a.Rb(0,"ion-header"),a.Rb(1,"ion-toolbar"),a.Rb(2,"ion-buttons",0),a.Mb(3,"ion-back-button",1),a.Qb(),a.Qb(),a.Qb(),a.Rb(4,"ion-content",2),a.Rb(5,"ion-row"),a.Rb(6,"ion-col",2),a.Rb(7,"ion-card",3),a.Rb(8,"ion-card-content"),a.Rb(9,"ion-row"),a.Rb(10,"ion-col",4),a.Rb(11,"ion-label",5),a.zc(12,"Name"),a.Qb(),a.Rb(13,"ion-input",6),a.Zb("ngModelChange",function(e){return s.user.name=e}),a.Qb(),a.Qb(),a.Rb(14,"ion-col",4),a.Rb(15,"ion-label",5),a.zc(16,"Access Level"),a.Qb(),a.Rb(17,"div",7),a.Zb("click",function(){return s.selectAccessLevel()}),a.xc(18,g,2,1,"span",8),a.xc(19,m,2,0,"span",8),a.Qb(),a.Qb(),a.Qb(),a.Rb(20,"ion-row"),a.Rb(21,"ion-col",4),a.Rb(22,"ion-label",5),a.zc(23,"E-mail"),a.Qb(),a.Rb(24,"ion-input",9),a.Zb("ngModelChange",function(e){return s.user.email=e}),a.Qb(),a.Qb(),a.Rb(25,"ion-col",4),a.Rb(26,"ion-label",5),a.zc(27,"Username"),a.Qb(),a.Rb(28,"ion-input",6),a.Zb("ngModelChange",function(e){return s.user.username=e}),a.Qb(),a.Qb(),a.Qb(),a.Rb(29,"ion-row"),a.Rb(30,"ion-col",10),a.Rb(31,"ion-label",5),a.zc(32,"Senha"),a.Qb(),a.Rb(33,"ion-input",11),a.Zb("ngModelChange",function(e){return s.user.password=e}),a.Qb(),a.Rb(34,"ion-text",12),a.Rb(35,"small"),a.zc(36," minimum 8 characters included with at least 1 upper case letter, 1 number, and 1 special character "),a.Qb(),a.Qb(),a.Qb(),a.Rb(37,"ion-col",4),a.Rb(38,"ion-label",5),a.zc(39,"Repita a Senha"),a.Qb(),a.Rb(40,"ion-input",11),a.Zb("ngModelChange",function(e){return s.user.password_confirmation=e}),a.Qb(),a.Qb(),a.Qb(),a.Rb(41,"ion-row"),a.Rb(42,"ion-col",13),a.Rb(43,"ion-button",14),a.Zb("click",function(){return s.save()}),a.zc(44," Save "),a.Qb(),a.Qb(),a.Qb(),a.Qb(),a.Qb(),a.Qb(),a.Qb(),a.Qb()),2&e&&(a.zb(3),a.jc("routerLink",a.lc(10,v)),a.zb(10),a.jc("ngModel",s.user.name),a.zb(5),a.jc("ngIf",null!=s.user.access_level.id),a.zb(1),a.jc("ngIf",null==s.user.access_level.id),a.zb(5),a.jc("ngModel",s.user.email),a.zb(4),a.jc("ngModel",s.user.username),a.zb(5),a.kc("placeholder",s.editing?"Only if you want to change":""),a.jc("ngModel",s.user.password),a.zb(7),a.kc("placeholder",s.editing?"Only if you want to change":""),a.jc("ngModel",s.user.password_confirmation))},directives:[h.n,h.O,h.g,h.d,h.e,h.Y,i.g,h.k,h.F,h.j,h.h,h.i,h.x,h.r,h.Z,d.g,d.h,p.l,h.K,h.f],styles:[""]}),e})();var R=t("HJNQ");const Q=[{path:"",component:f}];let w=(()=>{class e{}return e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=a.Jb({type:e}),e.\u0275inj=a.Ib({imports:[[R.a,i.i.forChild(Q)]]}),e})()}}]);