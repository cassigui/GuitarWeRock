(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{v3KL:function(e,i,t){"use strict";t.r(i),t.d(i,"IndexPageModule",function(){return ie});var c=t("tyNb"),n=t("HJNQ"),o=t("mrSG"),r=t("TEn/"),s=t("6rmw"),l=t("f1By"),d=t("fXoL"),b=t("e/r2"),a=t("IfTO"),p=t("u5X0"),u=t("G2dz"),f=t("ofXK"),h=t("3Pt+"),g=t("9nqD");const z=["search"];function m(e,i){if(1&e){const e=d.Sb();d.Rb(0,"ion-button",19),d.Zb("click",function(){return d.sc(e),d.dc(2).createMode()}),d.Mb(1,"ion-icon",20),d.Qb()}}function R(e,i){if(1&e&&(d.Rb(0,"ion-buttons",17),d.xc(1,m,2,0,"ion-button",18),d.Qb()),2&e){const e=d.dc();d.zb(1),d.jc("ngIf",!e.create_mode&&!e.project.finished)}}function x(e,i){if(1&e&&(d.Rb(0,"ion-text"),d.zc(1),d.Qb()),2&e){const e=d.dc().$implicit;d.zb(1),d.Bc(" ",e.fiscal_year," ")}}function Q(e,i){if(1&e){const e=d.Sb();d.Rb(0,"ion-col",25),d.Rb(1,"ion-input",26),d.Zb("ngModelChange",function(i){return d.sc(e),d.dc().$implicit.fiscal_year=i}),d.Qb(),d.Qb()}if(2&e){const e=d.dc().$implicit;d.zb(1),d.jc("ngModel",e.fiscal_year)("disabled",null!=e.id)}}function j(e,i){if(1&e&&(d.Rb(0,"ion-text"),d.zc(1),d.ec(2,"currency"),d.Qb()),2&e){const e=d.dc().$implicit;d.zb(1),d.Bc(" ",d.gc(2,1,e.ret,"R$ ")," ")}}function _(e,i){if(1&e){const e=d.Sb();d.Rb(0,"ion-col",25),d.Rb(1,"input",27),d.Zb("ngModelChange",function(i){return d.sc(e),d.dc().$implicit.ret=i}),d.Qb(),d.Qb()}if(2&e){const e=d.dc().$implicit;d.zb(1),d.jc("ngModel",e.ret)}}function v(e,i){if(1&e&&(d.Rb(0,"ion-text"),d.zc(1),d.ec(2,"currency"),d.Qb()),2&e){const e=d.dc().$implicit;d.zb(1),d.Bc(" ",d.gc(2,1,e.red,"R$ ")," ")}}function S(e,i){if(1&e){const e=d.Sb();d.Rb(0,"ion-col",25),d.Rb(1,"input",27),d.Zb("ngModelChange",function(i){return d.sc(e),d.dc().$implicit.red=i}),d.Qb(),d.Qb()}if(2&e){const e=d.dc().$implicit;d.zb(1),d.jc("ngModel",e.red)}}function $(e,i){if(1&e&&(d.Rb(0,"ion-text"),d.zc(1),d.ec(2,"currency"),d.Qb()),2&e){const e=d.dc().$implicit;d.zb(1),d.Bc(" ",d.gc(2,1,e.lab,"R$ ")," ")}}function y(e,i){if(1&e){const e=d.Sb();d.Rb(0,"ion-col",25),d.Rb(1,"input",27),d.Zb("ngModelChange",function(i){return d.sc(e),d.dc().$implicit.lab=i}),d.Qb(),d.Qb()}if(2&e){const e=d.dc().$implicit;d.zb(1),d.jc("ngModel",e.lab)}}function I(e,i){if(1&e&&(d.Rb(0,"ion-text"),d.zc(1),d.ec(2,"currency"),d.Qb()),2&e){const e=d.dc().$implicit;d.zb(1),d.Bc(" ",d.gc(2,1,e.federal_fee,"R$ ")," ")}}function M(e,i){if(1&e){const e=d.Sb();d.Rb(0,"ion-col",25),d.Rb(1,"input",27),d.Zb("ngModelChange",function(i){return d.sc(e),d.dc().$implicit.federal_fee=i}),d.Qb(),d.Qb()}if(2&e){const e=d.dc().$implicit;d.zb(1),d.jc("ngModel",e.federal_fee)}}function k(e,i){if(1&e&&(d.Rb(0,"ion-text"),d.zc(1),d.ec(2,"currency"),d.Qb()),2&e){const e=d.dc().$implicit;d.zb(1),d.Bc(" ",d.gc(2,1,e.state_fee,"R$ ")," ")}}function w(e,i){if(1&e){const e=d.Sb();d.Rb(0,"ion-col",25),d.Rb(1,"input",27),d.Zb("ngModelChange",function(i){return d.sc(e),d.dc().$implicit.state_fee=i}),d.Qb(),d.Qb()}if(2&e){const e=d.dc().$implicit;d.zb(1),d.jc("ngModel",e.state_fee)}}function C(e,i){if(1&e&&(d.Rb(0,"ion-text"),d.zc(1),d.ec(2,"currency"),d.Qb()),2&e){const e=d.dc().$implicit;d.zb(1),d.Bc(" ",d.gc(2,1,e.others,"R$ ")," ")}}function E(e,i){if(1&e){const e=d.Sb();d.Rb(0,"ion-col",25),d.Rb(1,"input",27),d.Zb("ngModelChange",function(i){return d.sc(e),d.dc().$implicit.others=i}),d.Qb(),d.Qb()}if(2&e){const e=d.dc().$implicit;d.zb(1),d.jc("ngModel",e.others)}}function T(e,i){if(1&e&&(d.Rb(0,"ion-text"),d.zc(1),d.ec(2,"currency"),d.Qb()),2&e){const e=d.dc().$implicit;d.zb(1),d.Bc(" ",d.gc(2,1,e.total_performed,"R$ ")," ")}}function B(e,i){if(1&e){const e=d.Sb();d.Rb(0,"ion-col",25),d.Rb(1,"input",28),d.Zb("ngModelChange",function(i){return d.sc(e),d.dc().$implicit.total_performed=i}),d.Qb(),d.Qb()}if(2&e){const e=d.dc().$implicit;d.zb(1),d.jc("ngModel",e.total_performed)}}function Z(e,i){if(1&e&&(d.Rb(0,"ion-text"),d.zc(1),d.ec(2,"currency"),d.Qb()),2&e){const e=d.dc().$implicit;d.zb(1),d.Bc(" ",d.gc(2,1,e.total,"R$ ")," ")}}function A(e,i){if(1&e&&(d.Rb(0,"ion-col",29),d.zc(1),d.ec(2,"currency"),d.Qb()),2&e){const e=d.dc().$implicit;d.zb(1),d.Bc(" ",d.gc(2,1,e.total,"R$ ")," ")}}function F(e,i){if(1&e){const e=d.Sb();d.Rb(0,"ion-button",35),d.Zb("click",function(){d.sc(e);const i=d.dc(2),t=i.$implicit,c=i.index;return d.dc(2).editMode(t,c)}),d.zc(1," Edit "),d.Qb()}if(2&e){const e=d.dc(2).$implicit;d.jc("disabled",e.finished)}}function P(e,i){if(1&e){const e=d.Sb();d.Rb(0,"ion-button",36),d.Zb("click",function(){d.sc(e);const i=d.dc(2),t=i.$implicit,c=i.index;return d.dc(2).save(t,c)}),d.zc(1," Save "),d.Qb()}}function L(e,i){if(1&e){const e=d.Sb();d.Rb(0,"ion-button",37),d.Zb("click",function(){d.sc(e);const i=d.dc(2),t=i.$implicit,c=i.index;return d.dc(2).cancel(t,c)}),d.zc(1," Cancel "),d.Qb()}}function O(e,i){if(1&e){const e=d.Sb();d.Rb(0,"ion-button",38),d.Zb("click",function(i){d.sc(e);const t=d.dc(2),c=t.$implicit,n=t.index;return d.dc(2).finishedPopover(c,n,i)}),d.zc(1),d.Qb()}if(2&e){const e=d.dc(2).$implicit;d.jc("disabled",e.finished),d.zb(1),d.Bc(" ",e.finished?"Finalize":"Finalized"," ")}}function D(e,i){if(1&e&&(d.Rb(0,"ion-col",30),d.xc(1,F,2,1,"ion-button",31),d.xc(2,P,2,0,"ion-button",32),d.xc(3,L,2,0,"ion-button",33),d.xc(4,O,2,2,"ion-button",34),d.Qb()),2&e){const e=d.dc().$implicit,i=d.dc(2);d.zb(1),d.jc("ngIf",!e.edit&&!i.edit_mode),d.zb(1),d.jc("ngIf",e.edit),d.zb(1),d.jc("ngIf",e.edit),d.zb(1),d.jc("ngIf",!e.edit&&e.id&&!i.project.finished)}}const Y=function(){return{update:"capital_expenditures"}},J=function(e){return[e]};function X(e,i){if(1&e&&(d.Rb(0,"ion-item"),d.Rb(1,"ion-col",10),d.zc(2),d.Qb(),d.Rb(3,"ion-col",10),d.xc(4,x,2,1,"ion-text",12),d.xc(5,Q,2,2,"ion-col",22),d.Qb(),d.Rb(6,"ion-col",10),d.xc(7,j,3,4,"ion-text",12),d.xc(8,_,2,1,"ion-col",22),d.Qb(),d.Rb(9,"ion-col",10),d.xc(10,v,3,4,"ion-text",12),d.xc(11,S,2,1,"ion-col",22),d.Qb(),d.Rb(12,"ion-col",10),d.xc(13,$,3,4,"ion-text",12),d.xc(14,y,2,1,"ion-col",22),d.Qb(),d.Rb(15,"ion-col",10),d.xc(16,I,3,4,"ion-text",12),d.xc(17,M,2,1,"ion-col",22),d.Qb(),d.Rb(18,"ion-col",10),d.xc(19,k,3,4,"ion-text",12),d.xc(20,w,2,1,"ion-col",22),d.Qb(),d.Rb(21,"ion-col",10),d.xc(22,C,3,4,"ion-text",12),d.xc(23,E,2,1,"ion-col",22),d.Qb(),d.Rb(24,"ion-col",10),d.xc(25,T,3,4,"ion-text",12),d.xc(26,B,2,1,"ion-col",22),d.Qb(),d.Rb(27,"ion-col",10),d.xc(28,Z,3,4,"ion-text",12),d.xc(29,A,3,4,"ion-col",23),d.Qb(),d.xc(30,D,5,4,"ion-col",24),d.Qb()),2&e){const e=i.$implicit;d.zb(2),d.Bc(" ",e.created_at.format("MMM DD, YYYY")," "),d.zb(2),d.jc("ngIf",!e.edit),d.zb(1),d.jc("ngIf",e.edit),d.zb(2),d.jc("ngIf",!e.edit),d.zb(1),d.jc("ngIf",e.edit),d.zb(2),d.jc("ngIf",!e.edit),d.zb(1),d.jc("ngIf",e.edit),d.zb(2),d.jc("ngIf",!e.edit),d.zb(1),d.jc("ngIf",e.edit),d.zb(2),d.jc("ngIf",!e.edit),d.zb(1),d.jc("ngIf",e.edit),d.zb(2),d.jc("ngIf",!e.edit),d.zb(1),d.jc("ngIf",e.edit),d.zb(2),d.jc("ngIf",!e.edit),d.zb(1),d.jc("ngIf",e.edit),d.zb(2),d.jc("ngIf",!e.edit),d.zb(1),d.jc("ngIf",e.edit),d.zb(2),d.jc("ngIf",!e.edit),d.zb(1),d.jc("ngIf",e.edit),d.zb(1),d.jc("ifAuth",d.mc(21,J,d.lc(20,Y)))}}function H(e,i){if(1&e&&(d.Rb(0,"ion-list"),d.xc(1,X,31,23,"ion-item",21),d.Qb()),2&e){const e=d.dc();d.zb(1),d.jc("ngForOf",e.capital_expenditures)}}function K(e,i){1&e&&(d.Rb(0,"div"),d.Mb(1,"ion-skeleton-text",39),d.Qb())}const G=function(){return[1,2,3,4,5]};function N(e,i){1&e&&(d.Pb(0),d.xc(1,K,2,0,"div",21),d.Ob()),2&e&&(d.zb(1),d.jc("ngForOf",d.lc(1,G)))}function V(e,i){if(1&e){const e=d.Sb();d.Rb(0,"ion-row",40),d.Rb(1,"ion-col",41),d.Rb(2,"ion-icon",42),d.Zb("click",function(){return d.sc(e),d.dc().content.scrollToTop(500)}),d.Qb(),d.Rb(3,"ion-label",43),d.zc(4," Todos registros foram listados "),d.Mb(5,"ion-icon",44),d.Qb(),d.Qb(),d.Qb()}if(2&e){const e=d.dc();d.zb(2),d.jc("hidden",e.capital_expenditures.length<10)}}function q(e,i){1&e&&(d.Rb(0,"ion-row",45),d.Rb(1,"ion-col",41),d.Rb(2,"ion-label",46),d.zc(3,"  Não há registros. "),d.Qb(),d.Qb(),d.Qb())}const U=function(){return["/projects"]},W=function(){return{create:"capital_expenditures"}},ee=[{path:"",component:(()=>{class e{constructor(e,i,t,c,n){this.projectService=e,this.helperService=i,this.capitalExpenditureService=t,this.route=c,this.router=n,this.project=new s.a,this.capital_expenditures=[],this.clone_capital_expenditures=[],this.loading=!1,this.project_id=null,this.create_mode=!1,this.edit_mode=!1}ngOnInit(){}ionViewWillEnter(){this.project_id=this.route.snapshot.paramMap.get("id")?parseInt(this.route.snapshot.paramMap.get("id")):null,this.getProject(),this.getCapitalExpenditures()}getProject(){this.projectService.find(["product.product_class"],{id:this.project_id}).then(e=>{this.project=e.project},e=>{this.helperService.toastResponse(e)})}getCapitalExpenditures(e=null){this.loading=!0,this.capitalExpenditureService.get([],{project_id:this.project_id,orderBy:"fiscal_year"}).then(i=>Object(o.a)(this,void 0,void 0,function*(){this.capital_expenditures=i.capital_expenditures.map(e=>new l.a(e)),this.loading=!1,e&&e.target.complete()}),i=>{this.helperService.responseErrors(i),e&&e.target.complete()})}finishedPopover(e,i,t){return Object(o.a)(this,void 0,void 0,function*(){let c=yield this.helperService.popover(t,"He is sure?",[{text:"back",color:"gray",value:!1},{text:"yes",color:"success",value:!0}]);c.onDidDismiss().then(t=>{!0===t.data&&(this.helperService.loading("Finishing"),this.finished(e,i))}),c.present()})}finished(e,i){this.project.finished&&(this.helperService.toast("danger","Project already finalized"),this.router.navigate(["projects"])),this.capitalExpenditureService.finished(e.id).then(i=>{i.error||(e.finished=i.capital_expenditure.finished),this.helperService.toast(i.error?"danger":"success",i.message),this.helperService.loading_dismiss()},e=>{this.helperService.toastResponse(e),this.helperService.loading_dismiss()})}createMode(){this.project.finished&&(this.helperService.toast("danger","Project already finalized"),this.router.navigate(["projects"])),this.create_mode=!0,this.capital_expenditures.unshift(new l.a),this.capital_expenditures[0].edit=!0,this.capital_expenditures[0].project_id=this.project_id,this.edit_mode=!0}editMode(e,i){this.edit_mode=!0,e.edit=!0}cancel(e,i){e.id?e.edit=!1:this.capital_expenditures.splice(i,1),this.edit_mode=!1,this.create_mode=!1}save(e,i){e.id>0?this.update(e,i):this.store(e,i)}store(e,i){this.project.finished&&(this.helperService.toast("danger","Project already finalized"),this.router.navigate(["projects"])),this.helperService.loading("Saving"),this.capitalExpenditureService.store(e).then(e=>{this.helperService.loading_dismiss(),e.error?this.helperService.toast("danger",e.message):(this.helperService.toast("success",e.message),this.capital_expenditures[i]=new l.a(e.capital_expenditure),this.edit_mode=!1,this.create_mode=!1)},e=>{this.helperService.loading_dismiss(),this.helperService.responseErrors(e)})}update(e,i){this.helperService.loading("Updating"),this.capitalExpenditureService.update(e).then(i=>{this.helperService.loading_dismiss(),i.error?this.helperService.toast("danger",i.message):(e.edit=!1,this.edit_mode=!1,this.create_mode=!1,this.helperService.toast("success",i.message))},e=>{this.helperService.loading_dismiss(),this.helperService.responseErrors(e)})}getTotal(e){return this.capital_expenditures.length?this.capital_expenditures.map(i=>i[e]).reduce((e,i)=>1*e+1*i,0):0}}return e.\u0275fac=function(i){return new(i||e)(d.Lb(b.a),d.Lb(a.a),d.Lb(p.a),d.Lb(c.a),d.Lb(c.f))},e.\u0275cmp=d.Fb({type:e,selectors:[["app-index"]],viewQuery:function(e,i){if(1&e&&(d.Ec(z,1),d.Ec(r.k,1),d.Ec(r.p,1)),2&e){let e;d.pc(e=d.ac())&&(i.search=e.first),d.pc(e=d.ac())&&(i.content=e.first),d.pc(e=d.ac())&&(i.infiniteScroll=e.first)}},decls:70,vars:44,consts:[["mode","ios"],["slot","start"],["icon","chevron-back-outline","mode","ios","text","",3,"routerLink"],[3,"click"],["slot","end",4,"ifAuth"],[1,"ion-no-padding"],["slot","fixed",1,"text-darkprimary",3,"ionRefresh"],["refreshingSpinner","dots"],["lines","full","mode","ios",1,"no-border","mb-0"],["mode","md"],["size","1"],["size","2"],[4,"ngIf"],["class","no-border","text-center","",4,"ngIf"],["color","light","text-center","",4,"ngIf"],["mode","ios",1,"pt-10","pb-10"],[2,"color","white"],["slot","end"],["mode","ios","color","white",3,"click",4,"ngIf"],["mode","ios","color","white",3,"click"],["name","add-circle"],[4,"ngFor","ngForOf"],["size","12",4,"ngIf"],["size","12","class","div-input-light",4,"ngIf"],["size","2","class","text-right",4,"ifAuth"],["size","12"],["type","number",1,"input-light",3,"ngModel","disabled","ngModelChange"],["currencyMask","",1,"input-light",3,"ngModel","ngModelChange"],["type","text","currencyMask","",1,"input-light",3,"ngModel","ngModelChange"],["size","12",1,"div-input-light"],["size","2",1,"text-right"],["size","small","color","primary","shape","round",3,"disabled","click",4,"ngIf"],["size","small","color","success","shape","round",3,"click",4,"ngIf"],["size","small","color","danger","shape","round",3,"click",4,"ngIf"],["size","small","shape","round","color","success",3,"disabled","click",4,"ngIf"],["size","small","color","primary","shape","round",3,"disabled","click"],["size","small","color","success","shape","round",3,"click"],["size","small","color","danger","shape","round",3,"click"],["size","small","shape","round","color","success",3,"disabled","click"],["animated","",2,"width","100%","height","50px"],["text-center","",1,"no-border"],[1,"text-center"],["color","medium","size","large","name","caret-up-circle-outline",1,"ion-float-end",3,"hidden","click"],["color","medium",1,"p20"],["name","thumbs-up","color","medium"],["color","light","text-center",""],["padding-top","","padding-bottom",""]],template:function(e,i){1&e&&(d.Rb(0,"ion-header"),d.Rb(1,"ion-toolbar",0),d.Rb(2,"ion-buttons",1),d.Mb(3,"ion-back-button",2),d.Qb(),d.Rb(4,"ion-title",3),d.Zb("click",function(){return i.content.scrollToTop(500)}),d.zc(5),d.Qb(),d.xc(6,R,2,1,"ion-buttons",4),d.Qb(),d.Qb(),d.Rb(7,"ion-content",5),d.Rb(8,"ion-refresher",6),d.Zb("ionRefresh",function(e){return i.getCapitalExpenditures(e)}),d.Mb(9,"ion-refresher-content",7),d.Qb(),d.Rb(10,"ion-row"),d.Rb(11,"ion-col",5),d.Rb(12,"ion-list",8),d.Rb(13,"ion-item-divider",9),d.Rb(14,"ion-col",10),d.zc(15,"Created At"),d.Qb(),d.Rb(16,"ion-col",10),d.zc(17,"Fiscal Year."),d.Qb(),d.Rb(18,"ion-col",10),d.zc(19,"RET"),d.Qb(),d.Rb(20,"ion-col",10),d.zc(21,"R&D"),d.Qb(),d.Rb(22,"ion-col",10),d.zc(23,"LAB"),d.Qb(),d.Rb(24,"ion-col",10),d.zc(25,"Fed. Fees"),d.Qb(),d.Rb(26,"ion-col",10),d.zc(27,"State. Fees"),d.Qb(),d.Rb(28,"ion-col",10),d.zc(29,"Others"),d.Qb(),d.Rb(30,"ion-col",10),d.zc(31,"Total Performed"),d.Qb(),d.Rb(32,"ion-col",10),d.zc(33,"Total"),d.Qb(),d.Mb(34,"ion-col",11),d.Qb(),d.xc(35,H,2,1,"ion-list",12),d.xc(36,N,2,2,"ng-container",12),d.xc(37,V,6,1,"ion-row",13),d.xc(38,q,4,0,"ion-row",14),d.Qb(),d.Qb(),d.Qb(),d.Qb(),d.Rb(39,"ion-footer",0),d.Rb(40,"ion-toolbar",15),d.Rb(41,"ion-row",16),d.Rb(42,"ion-col",11),d.zc(43,"Expected Spend"),d.Qb(),d.Rb(44,"ion-col",10),d.zc(45),d.ec(46,"currency"),d.Qb(),d.Rb(47,"ion-col",10),d.zc(48),d.ec(49,"currency"),d.Qb(),d.Rb(50,"ion-col",10),d.zc(51),d.ec(52,"currency"),d.Qb(),d.Rb(53,"ion-col",10),d.zc(54),d.ec(55,"currency"),d.Qb(),d.Rb(56,"ion-col",10),d.zc(57),d.ec(58,"currency"),d.Qb(),d.Rb(59,"ion-col",10),d.zc(60),d.ec(61,"currency"),d.Qb(),d.Rb(62,"ion-col",10),d.Rb(63,"strong"),d.zc(64),d.ec(65,"currency"),d.Qb(),d.Qb(),d.Rb(66,"ion-col",10),d.Rb(67,"strong"),d.zc(68),d.ec(69,"currency"),d.Qb(),d.Qb(),d.Qb(),d.Qb(),d.Qb()),2&e&&(d.zb(3),d.jc("routerLink",d.lc(40,U)),d.zb(2),d.Cc("",null==i.project.product?null:i.project.product.code," | ",null==i.project.product?null:i.project.product.name," | CAPEX Details"),d.zb(1),d.jc("ifAuth",d.mc(42,J,d.lc(41,W))),d.zb(29),d.jc("ngIf",!i.loading),d.zb(1),d.jc("ngIf",i.loading),d.zb(1),d.jc("ngIf",!i.loading&&i.capital_expenditures.length),d.zb(1),d.jc("ngIf",!i.loading&&!i.capital_expenditures.length),d.zb(7),d.Ac(d.gc(46,16,i.getTotal("ret"),"R$ ")),d.zb(3),d.Ac(d.gc(49,19,i.getTotal("red"),"R$ ")),d.zb(3),d.Ac(d.gc(52,22,i.getTotal("lab"),"R$ ")),d.zb(3),d.Ac(d.gc(55,25,i.getTotal("federal_fee"),"R$ ")),d.zb(3),d.Ac(d.gc(58,28,i.getTotal("state_fee"),"R$ ")),d.zb(3),d.Ac(d.gc(61,31,i.getTotal("others"),"R$ ")),d.zb(4),d.Bc(" ",d.gc(65,34,i.getTotal("total_performed"),"R$ ")," "),d.zb(4),d.Bc(" ",d.gc(69,37,i.getTotal("total"),"R$ ")," "))},directives:[r.n,r.O,r.g,r.d,r.e,r.Y,c.g,r.M,u.a,r.k,r.C,r.D,r.F,r.j,r.y,r.t,f.l,r.l,r.f,r.o,f.k,r.s,r.K,r.r,r.V,h.g,h.h,h.a,g.b,r.H,r.x],pipes:[f.c],styles:[""]}),e})()}];let ie=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=d.Jb({type:e}),e.\u0275inj=d.Ib({imports:[[n.a,c.i.forChild(ee)]]}),e})()}}]);
