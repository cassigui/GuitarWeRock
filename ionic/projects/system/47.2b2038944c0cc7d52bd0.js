(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{Qfdi:function(e,t,i){"use strict";i.r(t),i.d(t,"IndexPageModule",function(){return E});var o=i("tyNb"),n=i("HJNQ"),c=i("mrSG"),r=i("TEn/"),s=i("6rmw"),l=i("ktjF"),a=i("yoGk"),d=i("fXoL"),u=i("e/r2"),b=i("IfTO"),h=i("q9oa"),p=i("G2dz"),f=i("3Pt+"),m=i("ofXK");const g=["search"],v=function(){return["/projects/create"]};function z(e,t){1&e&&(d.Rb(0,"ion-button",23),d.Mb(1,"ion-icon",24),d.Qb()),2&e&&d.jc("routerLink",d.lc(1,v))}function j(e,t){if(1&e){const e=d.Sb();d.Rb(0,"ion-icon",31),d.Zb("click",function(){d.sc(e);const t=d.dc().$implicit;return d.dc().selectStatus(t)}),d.Qb()}}const R=function(e){return["/projects",e]};function Q(e,t){if(1&e&&(d.Rb(0,"ion-button",32),d.zc(1," edit "),d.Qb()),2&e){const e=d.dc().$implicit;d.jc("routerLink",d.mc(2,R,e.id))("disabled",e.finished)}}const S=function(e){return[e]};function k(e,t){if(1&e&&(d.Rb(0,"ion-button",33),d.zc(1," details "),d.Qb()),2&e){const e=d.dc().$implicit;d.jc("routerLink",d.mc(1,S,"/projects/"+e.id+"/project-comments"))}}function x(e,t){if(1&e&&(d.Rb(0,"ion-button",34),d.zc(1," CAPEX "),d.Qb()),2&e){const e=d.dc().$implicit;d.jc("routerLink",d.mc(1,S,"/projects/"+e.id+"/capital-expenditures"))}}function w(e,t){if(1&e){const e=d.Sb();d.Rb(0,"ion-button",35),d.Zb("click",function(t){d.sc(e);const i=d.dc().$implicit;return d.dc().finishedPopover(i,t)}),d.zc(1),d.Qb()}if(2&e){const e=d.dc().$implicit;d.jc("disabled",e.finished),d.zb(1),d.Bc(" ",e.finished?"finalized":"finalize"," ")}}const _=function(){return{update:"projects"}},y=function(){return{view:"project_comments"}},M=function(){return{view:"capital_expenditures"}};function A(e,t){if(1&e&&(d.Rb(0,"ion-item"),d.Rb(1,"ion-col",15),d.zc(2),d.Qb(),d.Rb(3,"ion-col",16),d.zc(4),d.Qb(),d.Rb(5,"ion-col",15),d.zc(6),d.Qb(),d.Rb(7,"ion-col",15),d.zc(8),d.Qb(),d.Rb(9,"ion-col",15),d.Rb(10,"ion-text"),d.zc(11),d.Qb(),d.xc(12,j,1,0,"ion-icon",25),d.Qb(),d.Rb(13,"ion-col",15),d.zc(14),d.Qb(),d.Rb(15,"ion-col",15),d.zc(16),d.Qb(),d.Rb(17,"ion-col",26),d.xc(18,Q,2,4,"ion-button",27),d.xc(19,k,2,3,"ion-button",28),d.xc(20,x,2,3,"ion-button",29),d.xc(21,w,2,2,"ion-button",30),d.Qb(),d.Qb()),2&e){const e=t.$implicit;d.zb(2),d.Bc("#",e.product.code,""),d.zb(2),d.Cc("",e.product.name," ",null==e.product.product_class?null:e.product.product_class.name,""),d.zb(2),d.Ac(e.process_type.name),d.zb(2),d.Ac((null==e.crop?null:e.crop.name)||"--"),d.zb(3),d.Bc(" ",(null==e.status?null:e.status.name)||"--"," "),d.zb(1),d.jc("ngIf",!e.finished),d.zb(2),d.Bc(" ",e.submission_date.format("MMM DD, YYYY"),""),d.zb(2),d.Bc(" ",e.expected_approval.format("MMM DD, YYYY"),""),d.zb(2),d.jc("ifAuth",d.mc(14,S,d.lc(13,_))),d.zb(1),d.jc("ifAuth",d.mc(17,S,d.lc(16,y))),d.zb(1),d.jc("ifAuth",d.mc(20,S,d.lc(19,M))),d.zb(1),d.jc("ifAuth",d.mc(23,S,d.lc(22,_)))}}function L(e,t){1&e&&(d.Rb(0,"div"),d.Mb(1,"ion-skeleton-text",36),d.Qb())}function F(e,t){if(1&e&&(d.Pb(0),d.xc(1,L,2,0,"div",17),d.Ob()),2&e){const e=d.dc();d.zb(1),d.jc("ngForOf",e.trs)}}function I(e,t){if(1&e){const e=d.Sb();d.Rb(0,"ion-row",37),d.Rb(1,"ion-col",38),d.Rb(2,"ion-icon",39),d.Zb("click",function(){return d.sc(e),d.dc().content.scrollToTop(500)}),d.Qb(),d.Rb(3,"ion-label",40),d.zc(4," Todos registros foram listados "),d.Mb(5,"ion-icon",41),d.Qb(),d.Qb(),d.Qb()}if(2&e){const e=d.dc();d.zb(2),d.jc("hidden",e.projects.length<10)}}function C(e,t){1&e&&(d.Rb(0,"ion-row",42),d.Rb(1,"ion-col",38),d.Rb(2,"ion-label",43),d.zc(3,"  Não há registros. "),d.Qb(),d.Qb(),d.Qb())}const O=function(){return{create:"projects"}},D=[{path:"",component:(()=>{class e{constructor(e,t,i,o){this.projectService=e,this.helperService=t,this.statusService=i,this.modalController=o,this.projects=[],this.loading=!1,this.statuses=[],this.filters={name:null,comment:null},this.total_of_data=0,this._paginate={take:40,page:1},this.trs=new Array(5),this.tds=new Array(1)}ngOnInit(){}ionViewWillEnter(){this.getStatuses(),this.paginate(null,null)}getFilters(){var e={};return Object.keys(this.filters).forEach(t=>{this.filters[t]&&(e[t]="%"+this.filters[t]+"%")},this),e.orderBy="!id",e}getStatuses(){this.statusService.get([]).then(e=>{this.statuses=e.statuses.map(e=>new l.a(e))},e=>{this.helperService.toastResponse(e)})}paginate(e=null,t=null){return Object(c.a)(this,void 0,void 0,function*(){(null!==e||null==e&&null==t)&&(this.projects=[],this._paginate.page=1),this.loading=!0,this.projectService.get(["creator","product.product_class","process_type","status","crop"],this.getFilters(),this._paginate).then(i=>Object(c.a)(this,void 0,void 0,function*(){this.total_of_data=i.projects.total,this._paginate.page=i.projects.current_page+1;for(let e of i.projects.data)this.projects.push(new s.a(e));this.loading=!1,e&&e.target.complete(),t&&t.target.complete()}),e=>{this.helperService.responseErrors(e)})})}remove(e,t,i){return Object(c.a)(this,void 0,void 0,function*(){let o=yield this.helperService.popover(t,"He is sure?",[{text:"back",color:"gray",value:!1},{text:"remove",color:"danger",value:!0}]);o.onDidDismiss().then(t=>{!0===t.data?(this.helperService.loading("Removendo"),this.destroy(e)):i.close()}),o.present()})}finishedPopover(e,t){return Object(c.a)(this,void 0,void 0,function*(){let i=yield this.helperService.popover(t,"He is sure?",[{text:"back",color:"gray",value:!1},{text:"yes",color:"success",value:!0}]);i.onDidDismiss().then(t=>{!0===t.data&&this.finished(e)}),i.present()})}destroy(e){this.projectService.destroy(e.id).then(t=>{if(!t.error){var i=this.projects.findIndex(t=>t.id==e.id);i>-1&&this.projects.splice(i,1)}this.helperService.toast(t.error?"warning":"success",t.message)},e=>{this.helperService.responseErrors(e)}).then(()=>this.helperService.loading_dismiss())}selectStatus(e){return Object(c.a)(this,void 0,void 0,function*(){const t=yield this.modalController.create({component:a.a,componentProps:{title:"Statuses",options:this.statuses.filter(t=>t.id!=e.status_id)}});yield t.present();const{data:i}=yield t.onWillDismiss();i&&this.updateStatus(e,i)})}updateStatus(e,t){this.helperService.loading("Changing status"),this.projectService.changeStatus(e.id,t).then(i=>{i.error||(e.status=t,e.status_id=t.id),this.helperService.loading_dismiss(),this.helperService.toast(i.error?"danger":"success",i.message)},e=>{this.helperService.loading_dismiss(),this.helperService.toastResponse(e)})}toggleSearch(){this.showFilter=!this.showFilter,this.showFilter&&setTimeout(()=>{this.search.setFocus()},100)}finished(e){this.helperService.loading("Finishing"),this.projectService.finished(e.id).then(t=>{t.error||(e.finished=t.project.finished),this.helperService.toast(t.error?"danger":"success",t.message),this.helperService.loading_dismiss()},e=>{this.helperService.toastResponse(e),this.helperService.loading_dismiss()})}}return e.\u0275fac=function(t){return new(t||e)(d.Lb(u.a),d.Lb(b.a),d.Lb(h.a),d.Lb(r.S))},e.\u0275cmp=d.Fb({type:e,selectors:[["app-index"]],viewQuery:function(e,t){if(1&e&&(d.Ec(g,1),d.Ec(r.k,1),d.Ec(r.p,1)),2&e){let e;d.pc(e=d.ac())&&(t.search=e.first),d.pc(e=d.ac())&&(t.content=e.first),d.pc(e=d.ac())&&(t.infiniteScroll=e.first)}},decls:41,vars:11,consts:[["mode","ios"],["mode","ios","slot","start"],[3,"click"],["slot","end"],["mode","ios","color","white",3,"routerLink",4,"ifAuth"],["mode","ios",3,"color","click"],["name","funnel"],[1,"ion-no-padding"],["slot","fixed",1,"text-darkprimary",3,"ionRefresh"],["refreshingSpinner","dots"],["lines","full","mode","ios",1,"no-border","mb-0"],["mode","md","color","customer",3,"hidden"],["debounce","250","placeholder","code ...",1,"p0",3,"ngModel","ngModelChange","ionChange"],["search",""],["mode","md"],["size","1"],["size","2"],[4,"ngFor","ngForOf"],[4,"ngIf"],["threshold","30px",3,"ionInfinite"],["loadingSpinner","none"],["class","no-border","text-center","",4,"ngIf"],["color","light","text-center","",4,"ngIf"],["mode","ios","color","white",3,"routerLink"],["name","add-circle"],["name","create","color","primary","class","cursor-pointer",3,"click",4,"ngIf"],[1,"text-right"],["size","small","shape","round",3,"routerLink","disabled",4,"ifAuth"],["size","small","shape","round",3,"routerLink",4,"ifAuth"],["size","small","shape","round","color","secondary",3,"routerLink",4,"ifAuth"],["size","small","color","success","shape","round",3,"disabled","click",4,"ifAuth"],["name","create","color","primary",1,"cursor-pointer",3,"click"],["size","small","shape","round",3,"routerLink","disabled"],["size","small","shape","round",3,"routerLink"],["size","small","shape","round","color","secondary",3,"routerLink"],["size","small","color","success","shape","round",3,"disabled","click"],["animated","",2,"width","100%","height","50px"],["text-center","",1,"no-border"],[1,"text-center"],["color","medium","size","large","name","caret-up-circle-outline",1,"ion-float-end","mt-15",3,"hidden","click"],["color","medium",1,"p20"],["name","thumbs-up","color","medium"],["color","light","text-center",""],["padding-top","","padding-bottom",""]],template:function(e,t){1&e&&(d.Rb(0,"ion-header"),d.Rb(1,"ion-toolbar",0),d.Mb(2,"ion-menu-button",1),d.Rb(3,"ion-title",2),d.Zb("click",function(){return t.content.scrollToTop(500)}),d.zc(4,"Projects"),d.Qb(),d.Rb(5,"ion-buttons",3),d.xc(6,z,2,2,"ion-button",4),d.Rb(7,"ion-button",5),d.Zb("click",function(){return t.toggleSearch()}),d.Mb(8,"ion-icon",6),d.Qb(),d.Qb(),d.Qb(),d.Qb(),d.Rb(9,"ion-content",7),d.Rb(10,"ion-refresher",8),d.Zb("ionRefresh",function(e){return t.paginate(e)}),d.Mb(11,"ion-refresher-content",9),d.Qb(),d.Rb(12,"ion-row"),d.Rb(13,"ion-col",7),d.Rb(14,"ion-list",10),d.Rb(15,"ion-item-divider",11),d.Rb(16,"ion-col"),d.Rb(17,"ion-searchbar",12,13),d.Zb("ngModelChange",function(e){return t.filters.product_code=e})("ionChange",function(){return t.paginate()}),d.Qb(),d.Qb(),d.Qb(),d.Rb(19,"ion-item-divider",14),d.Rb(20,"ion-col",15),d.zc(21,"Code"),d.Qb(),d.Rb(22,"ion-col",16),d.zc(23,"Brand"),d.Qb(),d.Rb(24,"ion-col",15),d.zc(25,"Process Type"),d.Qb(),d.Rb(26,"ion-col",15),d.zc(27,"Crop"),d.Qb(),d.Rb(28,"ion-col",15),d.zc(29,"Status"),d.Qb(),d.Rb(30,"ion-col",15),d.zc(31,"Sub. Date"),d.Qb(),d.Rb(32,"ion-col",15),d.zc(33,"Expected Approval"),d.Qb(),d.Qb(),d.Rb(34,"ion-list"),d.xc(35,A,22,25,"ion-item",17),d.Qb(),d.xc(36,F,2,1,"ng-container",18),d.Rb(37,"ion-infinite-scroll",19),d.Zb("ionInfinite",function(e){return t.paginate(null,e)}),d.Mb(38,"ion-infinite-scroll-content",20),d.Qb(),d.xc(39,I,6,1,"ion-row",21),d.xc(40,C,4,0,"ion-row",22),d.Qb(),d.Qb(),d.Qb(),d.Qb()),2&e&&(d.zb(6),d.jc("ifAuth",d.mc(9,S,d.lc(8,O))),d.zb(1),d.kc("color",t.showFilter?"medium":"white"),d.zb(8),d.jc("hidden",!t.showFilter),d.zb(2),d.jc("ngModel",t.filters.product_code),d.zb(18),d.jc("ngForOf",t.projects),d.zb(1),d.jc("ngIf",t.loading),d.zb(3),d.jc("ngIf",t.total_of_data===t.projects.length&&t.total_of_data>0),d.zb(1),d.jc("ngIf",!t.loading&&!t.projects.length))},directives:[r.n,r.O,r.A,r.M,r.g,p.a,r.f,r.o,r.k,r.C,r.D,r.F,r.j,r.y,r.t,r.G,r.Z,f.g,f.h,m.k,m.l,r.p,r.q,r.Y,o.g,r.s,r.K,r.H,r.x],styles:[""]}),e})()}];let E=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.Jb({type:e}),e.\u0275inj=d.Ib({imports:[[n.a,o.i.forChild(D)]]}),e})()}}]);
