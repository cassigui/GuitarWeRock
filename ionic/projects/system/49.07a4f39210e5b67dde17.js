(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{"5tFA":function(e,t,i){"use strict";i.r(t),i.d(t,"IndexPageModule",function(){return O});var o=i("tyNb"),n=i("HJNQ"),c=i("mrSG"),r=i("TEn/"),s=i("P/7m"),l=i("6rmw"),a=i("fXoL"),b=i("e/r2"),d=i("IfTO"),p=i("u5X0"),m=i("nMyB"),h=i("G2dz"),u=i("ofXK");const f=["search"],g=function(e){return[e]};function j(e,t){if(1&e&&(a.Rb(0,"ion-button",19),a.Mb(1,"ion-icon",20),a.Qb()),2&e){const e=a.dc();a.jc("routerLink",a.mc(1,g,"/projects/"+e.project.id+"/project-comments/create"))}}function v(e,t){if(1&e){const e=a.Sb();a.Rb(0,"ion-text",23),a.Zb("click",function(){a.sc(e);const t=a.dc().$implicit;return a.dc().viewMore(t.regulatory_comment,"Regulatory Comment")}),a.zc(1," view more "),a.Qb()}}function R(e,t){if(1&e){const e=a.Sb();a.Rb(0,"ion-text",23),a.Zb("click",function(){a.sc(e);const t=a.dc().$implicit;return a.dc().viewMore(t.technical_comment,"Technical Comment")}),a.zc(1," view more "),a.Qb()}}function z(e,t){if(1&e){const e=a.Sb();a.Rb(0,"ion-text",23),a.Zb("click",function(){a.sc(e);const t=a.dc().$implicit;return a.dc().viewMore(t.risk,"Risk")}),a.zc(1," view more "),a.Qb()}}function Q(e,t){if(1&e){const e=a.Sb();a.Rb(0,"ion-text",23),a.Zb("click",function(){a.sc(e);const t=a.dc().$implicit;return a.dc().viewMore(t.impact,"Impact")}),a.zc(1," view more "),a.Qb()}}function _(e,t){if(1&e&&(a.Rb(0,"ion-list"),a.Rb(1,"ion-item"),a.Rb(2,"ion-col",11),a.Rb(3,"ion-text",21),a.zc(4),a.Qb(),a.Qb(),a.Rb(5,"ion-col",11),a.zc(6),a.Qb(),a.Rb(7,"ion-col",11),a.zc(8),a.Qb(),a.Rb(9,"ion-col",11),a.zc(10),a.ec(11,"number"),a.Qb(),a.Rb(12,"ion-col",12),a.zc(13),a.xc(14,v,2,0,"ion-text",22),a.Qb(),a.Rb(15,"ion-col",12),a.zc(16),a.xc(17,R,2,0,"ion-text",22),a.Qb(),a.Rb(18,"ion-col",12),a.zc(19),a.xc(20,z,2,0,"ion-text",22),a.Qb(),a.Rb(21,"ion-col",12),a.zc(22),a.xc(23,Q,2,0,"ion-text",22),a.Qb(),a.Qb(),a.Qb()),2&e){const e=t.$implicit,i=a.dc();a.zb(4),a.Bc(" ",e.created_at.format("MMM dd, YYYY HH:mm:ss")," "),a.zb(2),a.Bc(" ",e.user_id?e.user.name:"--"," "),a.zb(2),a.Bc(" ",e.status_id?e.status.name:"--"," "),a.zb(2),a.Bc(" ",a.fc(11,12,e.progress),"% "),a.zb(3),a.Bc(" ",e.resume(e.regulatory_comment)," "),a.zb(1),a.jc("ngIf",i.showViewMore(e.regulatory_comment)),a.zb(2),a.Bc(" ",e.resume(e.technical_comment)," "),a.zb(1),a.jc("ngIf",i.showViewMore(e.technical_comment)),a.zb(2),a.Bc(" ",e.resume(e.risk)," "),a.zb(1),a.jc("ngIf",i.showViewMore(e.risk)),a.zb(2),a.Bc(" ",e.resume(e.impact)," "),a.zb(1),a.jc("ngIf",i.showViewMore(e.impact))}}function w(e,t){1&e&&(a.Rb(0,"div"),a.Mb(1,"ion-skeleton-text",24),a.Qb())}const x=function(){return[1,2,3,4,5]};function k(e,t){1&e&&(a.Pb(0),a.xc(1,w,2,0,"div",13),a.Ob()),2&e&&(a.zb(1),a.jc("ngForOf",a.lc(1,x)))}function S(e,t){if(1&e){const e=a.Sb();a.Rb(0,"ion-row",25),a.Rb(1,"ion-col",26),a.Rb(2,"ion-icon",27),a.Zb("click",function(){return a.sc(e),a.dc().content.scrollToTop(500)}),a.Qb(),a.Rb(3,"ion-label",28),a.zc(4," Todos registros foram listados "),a.Mb(5,"ion-icon",29),a.Qb(),a.Qb(),a.Qb()}if(2&e){const e=a.dc();a.zb(2),a.jc("hidden",e.project_comments.length<10)}}function y(e,t){1&e&&(a.Rb(0,"ion-row",30),a.Rb(1,"ion-col",26),a.Rb(2,"ion-label",31),a.zc(3,"  Não há registros. "),a.Qb(),a.Qb(),a.Qb())}const M=function(){return["/projects"]},I=function(){return{create:"project_comments"}},C=[{path:"",component:(()=>{class e{constructor(e,t,i,o,n,c){this.projectService=e,this.helperService=t,this.capitalExpenditureService=i,this.projectCommentService=o,this.route=n,this.alertCtrl=c,this.project=new l.a,this.project_comments=[],this.loading=!1,this.project_id=null,this.filters={name:null},this.total_of_data=0,this._paginate={take:30,page:1},this.trs=new Array(5),this.tds=new Array(1)}ngOnInit(){}ionViewWillEnter(){this.project_id=this.route.snapshot.paramMap.get("id")?parseInt(this.route.snapshot.paramMap.get("id")):null,this.getProject(),this.paginateProjectComments()}getFilters(){var e={};return Object.keys(this.filters).forEach(t=>{this.filters[t]&&(e[t]="%"+this.filters[t]+"%")},this),e.project_id=this.project_id,e.orderBy="!created_at",e}getProject(){this.projectService.find(["product.product_class"],{id:this.project_id}).then(e=>{this.project=e.project},e=>{this.helperService.toastResponse(e)})}paginateProjectComments(e=null,t=null){return Object(c.a)(this,void 0,void 0,function*(){(null!==e||null==e&&null==t)&&(this.project_comments=[],this._paginate.page=1),this.loading=!0,this.projectCommentService.get(["status","user"],this.getFilters(),this._paginate).then(i=>Object(c.a)(this,void 0,void 0,function*(){this.total_of_data=i.project_comments.total,this._paginate.page=i.project_comments.current_page+1;for(let e of i.project_comments.data)this.project_comments.push(new s.a(e));this.loading=!1,e&&e.target.complete(),t&&t.target.complete()}),e=>{this.helperService.responseErrors(e)})})}finishedPopover(e,t,i){return Object(c.a)(this,void 0,void 0,function*(){let o=yield this.helperService.popover(i,"He is sure?",[{text:"back",color:"gray",value:!1},{text:"yes",color:"success",value:!0}]);o.onDidDismiss().then(i=>{!0===i.data&&(this.helperService.loading("Finishing"),this.finished(e,t))}),o.present()})}finished(e,t){this.capitalExpenditureService.finished(e.id).then(t=>{t.error||(e.finished=t.capital_expenditure.finished),this.helperService.toast(t.error?"danger":"success",t.message),this.helperService.loading_dismiss()},e=>{this.helperService.toastResponse(e),this.helperService.loading_dismiss()})}viewMore(e,t){return Object(c.a)(this,void 0,void 0,function*(){(yield this.alertCtrl.create({cssClass:"resume-text",header:t,message:e,buttons:["Fechar"],animated:!0})).present()})}remove(e,t,i){return Object(c.a)(this,void 0,void 0,function*(){let o=yield this.helperService.popover(t,"He is sure?",[{text:"back",color:"gray",value:!1},{text:"remove",color:"danger",value:!0}]);o.onDidDismiss().then(t=>{!0===t.data?(this.helperService.loading("Removendo"),this.destroy(e,i)):i.close()}),o.present()})}destroy(e,t){this.projectCommentService.destroy(e.id).then(i=>{if(!i.error){var o=this.project_comments.findIndex(t=>t.id==e.id);o>-1&&this.project_comments.splice(o,1)}this.helperService.toast(i.error?"warning":"success",i.message),t.close()},e=>{this.helperService.responseErrors(e)}).then(()=>this.helperService.loading_dismiss())}showViewMore(e){return e&&e.length>60}}return e.\u0275fac=function(t){return new(t||e)(a.Lb(b.a),a.Lb(d.a),a.Lb(p.a),a.Lb(m.a),a.Lb(o.a),a.Lb(r.a))},e.\u0275cmp=a.Fb({type:e,selectors:[["app-index"]],viewQuery:function(e,t){if(1&e&&(a.Ec(f,1),a.Ec(r.k,1),a.Ec(r.p,1)),2&e){let e;a.pc(e=a.ac())&&(t.search=e.first),a.pc(e=a.ac())&&(t.content=e.first),a.pc(e=a.ac())&&(t.infiniteScroll=e.first)}},decls:37,vars:12,consts:[["mode","ios"],["slot","start"],["icon","chevron-back-outline","mode","ios","text","",3,"routerLink"],[3,"click"],["slot","end"],["mode","ios","color","white",3,"routerLink",4,"ifAuth"],[1,"ion-no-padding"],["slot","fixed",1,"text-darkprimary",3,"ionRefresh"],["refreshingSpinner","dots"],["lines","full","mode","ios",1,"no-border","mb-0"],["mode","md"],["size","1"],["size","2"],[4,"ngFor","ngForOf"],[4,"ngIf"],["threshold","30px",3,"ionInfinite"],["loadingSpinner","none"],["class","no-border","text-center","",4,"ngIf"],["color","light","text-center","",4,"ngIf"],["mode","ios","color","white",3,"routerLink"],["name","add-circle"],[2,"font-size","14px"],["color","primary",3,"click",4,"ngIf"],["color","primary",3,"click"],["animated","",2,"width","100%","height","50px"],["text-center","",1,"no-border"],[1,"text-center"],["color","medium","size","large","name","caret-up-circle-outline",1,"mt-15","ion-float-end",3,"hidden","click"],["color","medium",1,"p20"],["name","thumbs-up","color","medium"],["color","light","text-center",""],["padding-top","","padding-bottom",""]],template:function(e,t){1&e&&(a.Rb(0,"ion-header"),a.Rb(1,"ion-toolbar",0),a.Rb(2,"ion-buttons",1),a.Mb(3,"ion-back-button",2),a.Qb(),a.Rb(4,"ion-title",3),a.Zb("click",function(){return t.content.scrollToTop(500)}),a.zc(5),a.Qb(),a.Rb(6,"ion-buttons",4),a.xc(7,j,2,3,"ion-button",5),a.Qb(),a.Qb(),a.Qb(),a.Rb(8,"ion-content",6),a.Rb(9,"ion-refresher",7),a.Zb("ionRefresh",function(e){return t.paginateProjectComments(e)}),a.Mb(10,"ion-refresher-content",8),a.Qb(),a.Rb(11,"ion-row"),a.Rb(12,"ion-col",6),a.Rb(13,"ion-list",9),a.Rb(14,"ion-item-divider",10),a.Rb(15,"ion-col",11),a.zc(16,"Date/Hour"),a.Qb(),a.Rb(17,"ion-col",11),a.zc(18,"User"),a.Qb(),a.Rb(19,"ion-col",11),a.zc(20,"Status"),a.Qb(),a.Rb(21,"ion-col",11),a.zc(22,"Progress"),a.Qb(),a.Rb(23,"ion-col",12),a.zc(24,"Regulatory Comments"),a.Qb(),a.Rb(25,"ion-col",12),a.zc(26,"Technical Comments"),a.Qb(),a.Rb(27,"ion-col",12),a.zc(28,"Risk"),a.Qb(),a.Rb(29,"ion-col",12),a.zc(30,"Impact"),a.Qb(),a.Qb(),a.xc(31,_,24,14,"ion-list",13),a.xc(32,k,2,2,"ng-container",14),a.Rb(33,"ion-infinite-scroll",15),a.Zb("ionInfinite",function(e){return t.paginateProjectComments(null,e)}),a.Mb(34,"ion-infinite-scroll-content",16),a.Qb(),a.xc(35,S,6,1,"ion-row",17),a.xc(36,y,4,0,"ion-row",18),a.Qb(),a.Qb(),a.Qb(),a.Qb()),2&e&&(a.zb(3),a.jc("routerLink",a.lc(8,M)),a.zb(2),a.Cc("",null==t.project.product?null:t.project.product.code," | ",null==t.project.product?null:t.project.product.name," | Project Details"),a.zb(2),a.jc("ifAuth",a.mc(10,g,a.lc(9,I))),a.zb(24),a.jc("ngForOf",t.project_comments),a.zb(1),a.jc("ngIf",t.loading),a.zb(3),a.jc("ngIf",!t.loading&&t.project_comments.length&&t.total_of_data>0),a.zb(1),a.jc("ngIf",!t.loading&&!t.project_comments.length))},directives:[r.n,r.O,r.g,r.d,r.e,r.Y,o.g,r.M,h.a,r.k,r.C,r.D,r.F,r.j,r.y,r.t,u.k,u.l,r.p,r.q,r.f,r.o,r.s,r.K,r.H,r.x],pipes:[u.e],styles:[""]}),e})()}];let O=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.Jb({type:e}),e.\u0275inj=a.Ib({imports:[[n.a,o.i.forChild(C)]]}),e})()}}]);
